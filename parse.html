<!doctype html>
<html>
	<head>
		<script language="javascript">
			
			var xmlDoc;
			
			function load() {
				
				// the template to use for parsing the xml
				var template = [ "//label", { id: "@id", added: "@added" } ];
				
				parseArray( template, xmlDoc );
			}			
			
			/**
			* Parse xml according to the given json template
			*/
			function parseArray( template, xmldoc ) {
				var retVal = [];
				
				var xpathResult = xmldoc.evaluate( template[0], xmldoc, null, XPathResult.ANY_TYPE, null );
				var thisNode;
				while( thisNode = xpathResult.iterateNext() ) {
					var item;
					var newitem = {};
					for( item in template[1] ) {
						newitem[item] = xmldoc.evaluate( template[1][item], thisNode, null, XPathResult.STRING_TYPE, null ).stringValue;
						console.log( newitem[item] );
					}
					retVal.push( newitem );
				}
				return retVal;
			}
			
			function parse() {
			
			}
			
			/**
			* Load xml data from disk and return xml DOM
			*/
			function getXmlDoc() {
				xmlDoc = document.implementation.createDocument("", "", null);
				xmlDoc.load("labels.xml");
			}

			// crockford's typeOf function
			function typeOf(value) {
			var s = typeof value;
			if (s === 'object') {
				if (value) {
					if (typeof value.length === 'number' &&
							!(value.propertyIsEnumerable('length')) &&
							typeof value.splice === 'function') {
						s = 'array';
					}
				} else {
					s = 'null';
				}
			}
			return s;
		}

		</script>
	</head>
	<body onload="getXmlDoc();">
		<button onclick="load();">Load</button>
	</body>
</html>